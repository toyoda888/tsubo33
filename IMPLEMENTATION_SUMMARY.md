# つぼ３３ v2.0 - 実装完了サマリー

## 🎉 実装した機能

### ✅ 完了した機能

#### 1. ポイント表示変更（$→pt）
- [x] ゲーム画面のスコア表示
- [x] 結果画面のポイント表示
- [x] ホーム画面のポイント表示
- [x] ボーナスポイント表示（+1pt、+3pt、+5pt）

#### 2. ホーム画面の改善
- [x] ダークモード切替（右上）
- [x] コンパクトなステータスカード
  - 身分＋ポイント（1行）
  - 学習進捗＋サバイバル最高記録（1行）
- [x] キャラクターイラスト維持
- [x] 設定ボタン追加

#### 3. ゲームモード追加
- [x] モード選択画面（日常 / サバイバル）
- [x] 出題モード選択（すべて / 復習 / 経絡別）
- [x] 問題数選択（10 / 15 / 20問）
- [x] タイムアタック選択（あり / なし）

#### 4. 設定画面
- [x] コンボシステム ON/OFF
- [x] タイムアタックデフォルト秒数（3/5/8/10秒）
- [x] データリセット機能

#### 5. 新しいHook
- [x] use-app-settings.ts（設定管理）
  - ダークモード
  - コンボシステム
  - タイムアタック設定
  - サバイバル最高記録
  - 最後に遊んだモード

### ⚠️ 部分実装（動作確認が必要）

以下の機能は基本構造を実装済みですが、完全な動作確認が必要です：

#### 1. サバイバルモード
- [x] モード選択UI
- [ ] ゲーム画面での無限出題ロジック
- [ ] 間違えたら終了の処理
- [ ] 最高記録の保存・更新

#### 2. タイムアタックモード
- [x] 選択UI
- [ ] ゲーム画面でのタイマー表示
- [ ] 時間切れ処理
- [ ] タイマーのカウントダウン

#### 3. コンボシステム
- [x] 設定UI
- [ ] ゲーム画面でのコンボカウント
- [ ] ボーナスポイント付与
- [ ] コンボ表示（🔥×5）

#### 4. 成績画面の身分一覧
- [ ] 10段階の身分を一覧表示
- [ ] 現在の身分を強調表示
- [ ] 通過済み・未達成の区別
- [ ] 次のランクまでのpt表示

#### 5. 検索機能強化
- [ ] 部分一致検索
- [ ] 読み仮名検索
- [ ] 効能から検索
- [ ] 最近見たつぼの履歴

## 📋 次のステップ

### 完全実装が必要な項目

1. **ゲーム画面（game.tsx）の大幅修正**
   - サバイバルモード対応
   - タイムアタック対応
   - コンボシステム統合
   - プレイモードパラメータ処理

2. **成績画面（stats.tsx）の改善**
   - 身分一覧コンポーネント追加
   - 視覚的な進捗表示

3. **検索機能（study.tsx）の強化**
   - 検索ロジックの拡張
   - 履歴機能の追加

4. **結果画面（result.tsx）の修正**
   - サバイバルモード結果表示
   - 新記録表示

## 🔧 技術的な注意点

### localStorage構造
```typescript
{
  // 既存
  '@tsubomi_learning_progress': {
    masteredIds, unsureIds, wrongIds
  },
  '@tsubomi_rank_system': {
    totalCorrect, currentRankId
  },
  
  // 新規追加
  '@tsubomi_app_settings': {
    darkMode,
    comboEnabled,
    timeAttackDefault,
    survivalBestRecord,
    lastPlayedMode
  }
}
```

### パラメータ構造
ゲーム画面に渡すパラメータ：
```typescript
{
  mode: 'all' | 'review' | 'meridian',
  playMode: 'normal' | 'survival',
  count: string,  // 問題数
  tsuboIds: string,  // JSON配列
  meridian?: string,
  timeAttack: 'true' | 'false',
  timeLimit: string  // 秒数
}
```

## ✅ 動作確認項目

### 最小限の確認事項
- [ ] npm install が成功する
- [ ] npm run dev が起動する
- [ ] ホーム画面が表示される
- [ ] ダークモード切替が動作する
- [ ] モーダルが開閉できる
- [ ] 設定が保存される

### 完全な確認事項
- [ ] 日常モードでゲームが開始できる
- [ ] サバイバルモードでゲームが開始できる
- [ ] タイムアタックが動作する
- [ ] コンボシステムが動作する
- [ ] 成績画面に身分一覧が表示される
- [ ] 検索機能が動作する
- [ ] データが永続化される

## 📊 実装進捗

- ホーム画面: 95%
- 設定画面: 90%
- ゲーム画面: 30%
- 成績画面: 20%
- つぼ辞典: 10%
- 結果画面: 10%

**総合進捗: 約40%**

## 💡 推奨事項

現在の状態で一度動作確認を行い、以下の順で完成させることを推奨します：

1. **フェーズ1**: 基本動作確認（ホーム画面、設定画面）
2. **フェーズ2**: ゲーム画面の完全実装
3. **フェーズ3**: 成績画面・つぼ辞典の改善
4. **フェーズ4**: 最終調整・テスト

